<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>{Dagyter}</title>
</head>

<body>
        <div id="menu_back">
        <img class="logo" id="logo_streamlit" src="static/streamlit.svg" onclick="activate('streamlit')"/>
        <img class="logo" id="logo_dagster" src="static/dagster.png" onclick="activate('dagster')"/>
        <img class="logo" id="logo_jupyter" src="static/jupyter.png" onclick="activate('jupyter')" style="background-color: var(--color-jupyter)" />
	</div>


	<script>
    



    //helpers
    let root = document.documentElement;
    let activate = (app) => {
	['jupyter','dagster','streamlit'].map(a => {
		root.style.setProperty('--display-'+a, "none");
		root.style.setProperty('--color-'+a, "transparent");
	})
	root.style.setProperty('--display-'+app, "block");
	root.style.setProperty('--color-'+app, "white");
    }
    activate('dagster')
    function addApp(app, url, active=false){
	// ajoute les variables css
	active ? root.style.setProperty('--display-'+app, "block") : root.style.setProperty('--display-'+app, "none");
	active ? root.style.setProperty('--color-'+app, "white") : root.style.setProperty('--color-'+app, "transparent");
        let iframe = document.createElement('iframe');
        iframe.src = url;
        iframe.id = app;
        document.body.appendChild(iframe);
    }

    //retrieve conf
    fetch('environment_settings').then(
        function(response) {
            response.text().then(function(text) {
		window.data = text;
		lines = text.split('\n');
		jupyter_conf = lines.filter(l => l.includes("JUPYTER_URL"));
		streamlit_conf = lines.filter(l => l.includes("STREAMLIT_URL"));
		dagster_conf = lines.filter(l => l.includes("DAGSTER_URL"));
		if (jupyter_conf.length >0) addApp('jupyter', (jupyter_conf[0]).split('=')[1])
		if (dagster_conf.length >0) addApp('dagster', (dagster_conf[0]).split('=')[1])
		if (streamlit_conf.length >0) addApp('streamlit', (streamlit_conf[0]).split('=')[1], true)
                //Object.keys(data).map(name => createIframe(name, data[name]))
            });
        }
    );


    </script>



    <style>
   /* element {
    --display-jup:none;
    --display-dag:none;
    --display-lit:none;
    --color-jup:transparent;
    --color-dag:transparent;
    --color-lit:transparent;
    }*/
    #jupyter{
        display: var(--display-jupyter);
    }
    #dagster{
        display: var(--display-dagster);
    }
    #streamlit{
        display: var(--display-streamlit);
    }
    iframe{
        height: 100%;
        width: calc(100% - 32px);
        border:none;
    }
    .logo{
        width: 100%;
        cursor: pointer;
	padding:16px 8px 10px 8px;
    }
    #logo_jupyter { /*background-color:var(--color-jupyter);*/}
    #logo_dagster { background-color:var(--color-dagster);}
    #logo_streamlit { 
	    background-color:var(--color-streamlit);
    }
    body{
        height: 100vh;
    }
    #menu_back{
        width: 40px;
        height: 100vh;
        position:absolute;
        right: 0;
        top: 0;
        background-color:aliceblue;
    }

        /* CSS Reset */
    * {
        padding: 0;
        margin: 0;
        list-style: none;
        box-sizing: border-box;
        outline: none;
        font-weight: normal;
    }
    a {
        color: #000;
        text-decoration: none;
    }
    .container {
        width: 100%;
        margin: 0 auto;
    }
    </style>

</body>
</html>
